{"versions":[{"hash":"e134187ceebd270d53ad0db75b1fd66ed15a7bd6","date":1650880051,"message":"修复表单","author_name":"forc","author_email":"63189191+forcux@users.noreply.github.com","version":"1"}],"meta":{"type":"javascript","name":"Papago 网页翻译","version":"1","synopsis":"跳转到 Naver Papago 网页翻译","tags":["阅读脚本"],"detail":"<p>脚本会在网页右下角放置绿色的翻译按钮。</p><p>点击后选择语言即可跳转到 <a rel=\"noopener noreferrer\" href=\"https://papago.naver.net/website?locale=zh-CN\">Naver Papago 网页翻译</a></p><p class=\"ql-indent-1\"><br></p><p class=\"ql-indent-1\"><span style=\"background-color: rgb(68, 68, 68); color: rgb(250, 204, 204);\">这个脚本依赖于外部服务。</span></p><p class=\"ql-indent-1\"><span style=\"background-color: rgb(68, 68, 68); color: rgb(250, 204, 204);\">本作者不保证服务可用。</span></p><p class=\"ql-indent-1\"><span style=\"background-color: rgb(68, 68, 68); color: rgb(250, 204, 204);\">不对跳转后的页面的任何内容负责。</span></p><p><br></p><p>这个脚本使用了 Bext 的函数，</p><p>如需二次发布 ( 分享，搬运 等等 ) ，</p><p>需要在显著位置包含如下 MIT 许可文本:</p><p><br></p><p><br></p><pre spellcheck=\"false\" class=\"ql-syntax\">MIT License\nCopyright (c) 2022 ikkz\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n</pre><p><br></p>","source":"import { runNeed, addElement, addStyle, detectBrowser } from '@bext/util';\nimport config from '@bext/config';\nrunNeed(()=>(\n    document.body && location.host!=='papago.naver.net'\n),()=>{\n    const { top, left, black, white } = config;\n    if (black && black instanceof Array && black.includes(location.host)) return;\n    if (white && white instanceof Array && !white.includes(location.host)) return;\n    let sel = addElement({\n        tag: 'select',\n        attrs: {\n            id: 'papago_lang_sel'\n        },\n        to: document.body\n    }), pos = [], lock = document.createElement('style');\n    lock.textContent = 'html, body { overflow: hidden !important }';\n\n    sel.addEventListener('touchstart', e => {\n        pos = [\n            e.touches[0].clientX - sel.offsetLeft,\n            e.touches[0].clientY - sel.offsetTop\n        ];\n        document.body.appendChild(lock);\n    },{ passive: true });\n    sel.addEventListener('touchmove', e => {\n        sel.style.left = (e.touches[0].clientX - pos[0]) + 'px';\n\t\tsel.style.top = (e.touches[0].clientY - pos[1]) + 'px';\n    },{ passive: true });\n    sel.addEventListener('touchend', e => {\n        lock.remove();\n    },{ passive: true });\n\n    addStyle(`\n    #papago_lang_sel {\n        all: initial;\n        position: fixed;\n        z-index: 9999999;\n        font-size: 15px;\n        text-align: center;\n        margin: .5em;\n        padding: .25em;\n        border-radius: 2em;\n        box-shadow: 2px 0 5px gray;\n        user-select: none;\n        top: calc(100vh - 2.5em - ${top}px);\n        left: calc(100vw - 4.5em - ${left}px);\n        background-color: #00de68;\n        color: white;\n        opacity: 0.8;\n        width: 3em;\n    }`);\n\n    sel.appendChild(\n        new Option('翻译', '0', true, true)\n    );\n    sel.appendChild(\n        new Option('英文 -> 中文', 'en')\n    );\n    sel.appendChild(\n        new Option('日文 -> 中文', 'ja')\n    );\n    sel.appendChild(\n        new Option('韩文 -> 中文', 'ko')\n    );\n    sel.onchange = () => {\n        if (sel.value!=='0') {\n            let url = `https://papago.naver.net/website?locale=zh-CN&source=${sel.value}&target=zh-CN&url=${location.href}`;\n            if (detectBrowser()==='x' && typeof window.mbrowser.openUrlOnNewTab=='function') {\n                window.mbrowser.openUrlOnNewTab(url,31);\n            } else if (detectBrowser()==='meta' && typeof window.meta.openWindow=='function') {\n                window.meta.openWindow(url);\n            } else if (detectBrowser()==='mixia' && typeof window.mx_browser_obj.openUrl=='function') {\n                window.mx_browser_obj.openUrl(location.href,url,true);\n            } else if (typeof window.moe=='object' && typeof window.moe.openInTab=='function') {\n                window.moe.openInTab(url,false);\n            } else {\n                window.open(url);\n            }\n            document.querySelector('#papago_lang_sel [value=\"0\"]').selected = true;\n        }        \n    };\n});","configSchema":{"type":"object","properties":{"top":{"type":"integer","description":"按钮底部距离页面底部的偏移\n( 不包括按钮的外边距 7.5px )","title":"按钮向上位置"},"left":{"type":"integer","title":"按钮向左位置","description":"按钮右部距离页面右边的偏移\n( 不包括按钮的外边距 7.5px )"},"black":{"type":"array","items":{"type":"string","format":"hostname","description":"不会在这个域名添加按钮"},"title":"域名黑名单"},"white":{"type":"array","items":{"type":"string","description":"只会在这个域名添加按钮","format":"hostname"},"title":"域名白名单"}},"required":["top","left"],"title":"设置","description":"如果需要在安装以后修改设置，请卸载以后重新安装"},"defaultConfig":{"top":20,"left":0}},"hash":"e134187ceebd270d53ad0db75b1fd66ed15a7bd6"}