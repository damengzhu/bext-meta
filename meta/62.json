{"type":"javascript","name":" H5视频调速器","version":"2","synopsis":"一个针对手机浏览器的H5视频调速器","tags":["视频脚本"],"detail":"<p>搬运自 <a rel=\"noopener noreferrer\" href=\"http://via-app.cn/#/pluginDetail/62\">Via 轻插件</a> ，作者 <a rel=\"noopener noreferrer\" href=\"http://via-app.cn/#/user/38\">MrNullNull</a></p><p><br></p><p>对原脚本进行如下修改 ：</p><ul><li>适配本站安装选项</li></ul><p><br></p><p>以下是原版介绍：</p><p><br></p><p>右下角出现调速按钮，按就是了</p><p>未压缩代码请前往GF查看。</p><p><a style=\"color: rgb(240, 102, 102);\" rel=\"noopener noreferrer\" href=\"https://greasyfork.org/zh-CN/scripts/416764\">https://greasyfork.org/zh-CN/scripts/416764</a></p>","source":"// ==UserScript==\n// @name         [Via]H5视频调速器\n// @namespace    http://tampermonkey.net/\n// @version      0.1.4\n// @description  一个针对手机浏览器的H5视频调速器\n// @author       Mr.NullNull\n// @match        *://*/*\n// @grant        none\n// ==/UserScript==\n \n/*H5视频调速器，作者：Mr.NullNull*/\nimport config from '@bext/config';\n(function () {\n    'use strict';\n \n    var IntPbr = 1;\n \n    const IntPbrMax = config.IntPbrMax;\n    const IntPbrMin = config.IntPbrMin;\n    const IntPbrStep = config.IntPbrStep;\n \n    function Main() {\n        if (document.querySelector(\"myPbrMain\")) return;\n \n        var myCss = document.createElement(\"style\");\n        myCss.innerHTML = `\n            div#myPbrMain {\n                padding: 0;\n                margin: 0;\n                width: 1px;\n                position: fixed;\n                bottom: 28vw;\n                right: 5vw;\n                z-index: 2147483647;\n            }\n \n            div#myPbrMain>* {\n                float: right;\n            }\n \n            div#myPbrMain>div.myPbrBtns {\n                width: 1px;\n                margin-bottom: 2.2vw;\n            }\n \n            div.myPbrBtns {\n                opacity: 0;\n            }\n \n            div.myPbrBtn {\n                font: 4vw/1 '微软雅黑';\n                float: right;\n                height: 4vw;\n                padding: 2vw;\n                margin-bottom: 0.8vw;\n                border-radius: 20vw;\n                color: #eee;\n                background-color: rgba(0, 0, 0, 0.65);\n            }\n \n            div#myPbrMain>div.myPbrBtn {\n                width: auto;\n            }\n \n            div#myPbrMain * {\n                box-sizing: content-box;\n                word-break: normal;\n            }\n \n            div.show {\n                animation: shower 0.3s;\n                opacity: 1;\n                display: block;\n            }\n \n            div.hidden {\n                animation: hiddener 0.3s;\n                opacity: 0;\n                display: none;\n            }\n\n\n            @keyframes shower {\n                from {\n                    opacity: 0;\n                }\n                to {\n                    opacity: 1;\n                }\n            }\n \n            @keyframes hiddener {\n                from {\n                    opacity: 1;\n                }\n                to {\n                    opacity: 0;\n                }\n            }\n        `;\n        document.head.appendChild(myCss);\n \n        var mainDivTop = document.createElement(\"div\");\n        mainDivTop.id = \"myPbrMain\";\n        mainDivTop.innerHTML = `\n        <div class=\"myPbrBtns hidden\">\n            <div class=\"myPbrBtn\" id=\"myPbrBtn_800\">x8.00</div>\n            <div class=\"myPbrBtn\" id=\"myPbrBtn_300\">x3.00</div>\n            <div class=\"myPbrBtn\" id=\"myPbrBtn_200\">x2.00</div>\n            <div class=\"myPbrBtn\" id=\"myPbrBtn_150\">x1.50</div>\n            <div class=\"myPbrBtn\" id=\"myPbrBtn_125\">x1.25</div>\n            <div class=\"myPbrBtn\" id=\"myPbrBtn_100\">x1.00</div>\n            <div class=\"myPbrBtn\" id=\"myPbrBtn_075\">x0.75</div>\n            <div class=\"myPbrBtn\" id=\"myPbrBtn_050\">x0.50</div>\n            <div class=\"myPbrBtn\" id=\"myPbrBtn_Add\">+${IntPbrStep.toFixed(2)}</div>\n            <div class=\"myPbrBtn\" id=\"myPbrBtn_Cut\">-${IntPbrStep.toFixed(2)}</div>\n        </div>\n        <div class=\"myPbrBtn\" id=\"myPbrBtn_Main\">x1.XX</div>\n        `;\n        document.body.appendChild(mainDivTop);\n \n        var mainBtn = mainDivTop.querySelector(\"#myPbrBtn_Main\");\n        var mainDiv = mainDivTop.querySelector(\".myPbrBtns\");\n \n \n        setMainBtnTxt();\n \n \n        mainBtn.onclick = function () {\n            if (mainDiv.className == \"myPbrBtns hidden\") {\n                setMainDivShow();\n            } else {\n                setMainDivNone();\n            }\n        };\n \n        mainDiv.querySelector(\"#myPbrBtn_800\").onclick = function () {\n            IntPbr = 8;\n            setVideoPBR();\n            setMainBtnTxt();\n            setMainDivNone();\n        };\n        mainDiv.querySelector(\"#myPbrBtn_300\").onclick = function () {\n            IntPbr = 3;\n            setVideoPBR();\n            setMainBtnTxt();\n            setMainDivNone();\n        };\n        mainDiv.querySelector(\"#myPbrBtn_200\").onclick = function () {\n            IntPbr = 2.00;\n            setVideoPBR();\n            setMainBtnTxt();\n            setMainDivNone();\n        };\n        mainDiv.querySelector(\"#myPbrBtn_150\").onclick = function () {\n            IntPbr = 1.50;\n            setVideoPBR();\n            setMainBtnTxt();\n            setMainDivNone();\n        };\n        mainDiv.querySelector(\"#myPbrBtn_125\").onclick = function () {\n            IntPbr = 1.25;\n            setVideoPBR();\n            setMainBtnTxt();\n            setMainDivNone();\n        };\n        mainDiv.querySelector(\"#myPbrBtn_100\").onclick = function () {\n            IntPbr = 1.00;\n            setVideoPBR();\n            setMainBtnTxt();\n            setMainDivNone();\n        };\n        mainDiv.querySelector(\"#myPbrBtn_075\").onclick = function () {\n            IntPbr = 0.75;\n            setVideoPBR();\n            setMainBtnTxt();\n            setMainDivNone();\n        };\n        mainDiv.querySelector(\"#myPbrBtn_050\").onclick = function () {\n            IntPbr = 0.50;\n            setVideoPBR();\n            setMainBtnTxt();\n            setMainDivNone();\n        };\n \n        mainDiv.querySelector(\"#myPbrBtn_Add\").onclick = function () {\n            IntPbr += IntPbrStep;\n            setVideoPBR();\n            setMainBtnTxt();\n        };\n        mainDiv.querySelector(\"#myPbrBtn_Cut\").onclick = function () {\n            IntPbr -= IntPbrStep;\n            setVideoPBR();\n            setMainBtnTxt();\n        };\n \n \n        function setVideoPBR() {\n            if (IntPbr > IntPbrMax) {\n                IntPbr = IntPbrMax;\n            }\n            if (IntPbr < IntPbrMin) {\n                IntPbr = IntPbrMin;\n            }\n \n            var tmps = document.querySelectorAll(\"video\");\n            for (let i = 0; i < tmps.length; i++) {\n                const element = tmps[i];\n                element.playbackRate = IntPbr;\n            }\n            console.log(\"PBR = \" + IntPbr);\n        }\n \n        function setMainBtnTxt() {\n\t\t\tmainBtn.innerHTML = \"x\" + IntPbr.toFixed(2);\n        }\n \n        function setMainDivShow() {\n            mainDiv.className = \"myPbrBtns show\";\n        }\n \n        function setMainDivNone() {\n            mainDiv.className = \"myPbrBtns hidden\";\n        }\n    };\n \n    function Padding(num, length) {\n        return (Array(length).join(\"0\") + num).slice(-length);\n    }\n \n \n    var sli = setInterval(() => {\n        if (document.querySelector(\"video\")) {\n            Main();\n            clearInterval(sli);\n        }\n    }, 1000);\n    setTimeout(() => {\n        clearInterval(sli);\n    }, 10000);\n})();","configSchema":{"type":"object","properties":{"IntPbrMax":{"type":"number","title":"最大倍数","minimum":8},"IntPbrMin":{"type":"number","title":"最小倍数","maximum":0.5},"IntPbrStep":{"type":"number","title":"单步倍数","description":"加减一次调整的倍数"}},"required":["IntPbrMin","IntPbrStep","IntPbrMax"]},"defaultConfig":{"IntPbrMax":16,"IntPbrMin":0.1,"IntPbrStep":0.25}}